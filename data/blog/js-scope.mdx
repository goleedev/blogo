---
title: '😎 자바스크립트 스코프란'
thumbSrc: '/static/images/js6.png'
date: '2021-06-22'
tags: ['FE', 'JavaScript']
draft: false
summary: '모던 자바스크립트를 학습하며 정리한 자료로 스코프 (유효범위)에 대해 설명합니다.'
images: ['/static/images/js6.png']
---

# 📌 목차

![JS Scope](/static/images/js6.png)

- **💁🏻 스코프란**

- **🏭 스코프의 동작 과정**

- **✨ 스코프의 특징**

- **🧑🏻‍⚖️ 스코프의 규칙**

- **🗄️ 스코프의 종류**

- **🤫 암묵적 전역 변수**

---

# 💁🏻 스코프란

자신이 선언된 위치에 의해 다른 코드가 `식별자 자신을 참조할 수 있는 유효범위`이며, **자바스크립트 엔진이 식별자를 검색할 때 사용하는 규칙**입니다.

스코프는 `전역 스코프`와 `지역 스코프`로 구분할 수 있습니다.

- **전역 스코프 (Global scope)**: 어디에서든지 참조 가능

- **지역 스코프 (Local scope / Function-level scope)**: 자신이 선언된 지역과 하위 함수에서만 참조 가능하며, 자신의 지역 스코프와 하위 스코프에서 유효합니다. 이때, 함수에 의해서만 지역 스코프가 생성됩니다.

---

# 🏭 스코프의 동작 과정

```javascript
var a = 1

function foo() {
  var b = 2

  console.log(a)
  console.log(b)
}

foo()
console.log(b) // 'b'에 접근할 수 없음
```

- **함수 내부에 없는 변수 a를 불러오는 경우**는 식별자 결정 과정을 통해 함수 내부에서 먼저 a라는 변수를 찾고, 함수 내부에 변수 a가 없어 외부에서 변수 a를 찾아 불러옵니다.

- 변수 b는 **본인이 속한 함수 내에서만 접근이 가능**하도록 범위가 정해졌습니다.

---

# ✨ 스코프의 특징

- `var` 키워드로 선언된 변수는 **함수 레벨 스코프**를 따릅니다. 여기서 함수 레벨 스코프 (Function-level scope)이란 **함수 내에서 선언된 지역 변수는 함수 내에서만 유효하며, 함수 외부에서는 참조가 불가능**합니다.

- `let`과 `const` 키워드로 선언된 변수는 **블록 레벨 스코프**를 따릅니다. 여기서 블록 레벨 스코프 (Block-level scope)란 **코드 블록 내에서 선언된 변수는 코드 블록 내에서만 유효하며, 코드 블록 외부에서는 참조가 불가능**합니다. 코드 블록 내부에서 선언한 변수는 지역 변수라고 합니다.

---

# 🧑🏻‍⚖️ 스코프의 규칙

> Scope는 함수를 호출할 때가 아니라 선언할 때 생깁니다.

## 함수 내부에서 변수를 참조할 경우

- 함수 **내부에서** 변수를 먼저 찾습니다.
- 함수 내부에 존재하지 않으면, **함수 외부**에서 찾습니다.

## 함수 내부, 외부에 동일한 변수명이 존재할 경우

- 함수에서는 **내부의 변수를 우선시** 합니다.

## 함수 내부, 외부에서의 규칙

- `var`의 경우, **내부/외부를 판별하는 기준은 함수**가 됩니다.
- 함수 **내부에서 선언된 변수는 함수 외부에서 참조가 불가능**합니다.
- 함수 **외부에서 선언된 변수는 함수 내부에서 참조 가능**합니다.

---

# 🗄️ 스코프의 종류

## 전역 스코프 (Global Scope)

전역에 변수를 선언하면 이 변수는 **어디서든지 참조할 수 있는 전역 스코프를 갖는 전역 변수**가 됩니다.

`var` 키워드로 선언한 전역 변수는 **전역 객체 (Global Object)** 이며, **변수 이름을 겹치는 중복의 위험성**과

의도치 않은 **재할당에 의한 상태 변화로 코드를 예측하기 어려울 수 있다**는 문제점이 있습니다.

## 비 블록 레벨 스코프(Non block-level scope)

```javascript
if (true) {
  var x = 5
}

console.log(x) // 5;
```

여기서 변수 x는 코드 블록 내에서 선언되었지만, 자바스크립트는 **블록 레벨 스코프를 사용하지 않았습니다**.

이는 코드 블록 내에서 선언되었지만 함수 밖에서 선언된 변수는 모두 **전역스코프**를 갖게되기 때문입니다.

간단히 말해, 해당 경우에 변수 x는 **전역 변수**입니다.

## 함수 레벨 스코프 (Function-level scope)

```javascript
var x = 1

if (true) {
  // x는 전역 변수, 이미 선언된 전역 변수 x가 있어 x 변수는 중복 선언
  var x = 10
}

console.log(x) // 10
```

`var` 키워드로 선언한 변수는 **함수의 코드 블록만을 지역 스코프로 인정**합니다.

함수 외부에서 `var` 키워드로 선언한 변수는 코드 블록 내에서 선언해도 모두 **전역변수**가 됩니다.

```javascript
var i = 10

// var 키워드로 for 문에서 선언한 변수 i는 전역변수
// 이미 선언한 전역 변수 i가 있으므로 중복 선언

for (var i = 0; i < 5; i++) {
  console.log(i) // 0 1 2 3 4 5
}

// 의도치 않게 변수와 값이 변경
console.log(i) // 5
```

예시에서 처럼 `for 문`의 변수 선언문에서 `var` 키워드로 선언한 변수도 **전역 변수**가 됩니다.

## 렉시컬 스코프

함수를 **어디에 선언하였는지에 따라 결정되는 환경**을 말하며, 함수를 어디서 정의했는지에 따라 **상위 스코프를 결정**합니다.

함수가 호출된 위치는 스코프 결정에 아무런 의미를 주지 않으며, 즉 **함수의 상위 스코프는 자신이 정의된 스코프**를 말합니다.

함수 정의가 실행되어 생성된 함수 객체는 **함수 호출때마다 함수의 상위 스코프를 참조할 필요가 있어 결정된 상위 스코프를 기억**합니다.

```javascript
var x = 1

function foo() {
  var x = 10
  bar()
}

function bar() {
  console.log(x)
}

foo() // 1
bar() // 1
```

---

# 🤫 암묵적 전역 변수

```javascript
function foo() {
  x = 10
}

foo()
console.log(x) // 10
```

함수 foo 내에 선언되지 않은 **변수 x에 값 10을 할당**합니다.

변수 x의 참조를 찾아야 변수 x에 값을 할당할 수 있는데, 이떄 **자바스크립트 엔진이 스코프 체인에서 변수 x를 검색**하기 시작합니다.

foo 함수의 스코프에서 변수 x를 검색하고, foo 함수의 스코프에는 변수 x에 대한 변수 선언이 없으므로 검색에 실패하기 때문에

**foo 함수의 상위 컨텍스트 (위 예제의 경우 전역 스코프)에서 변수 x를 검색**합니다.

전역 스코프에도 변수 x가 존재하지 않기 때문에 ReferenceError를 발생시킬 것 같지만, **전역 변수 x를 암묵적으로 생성하고 값을 할당**합니다.

`var` 키워드를 생략한 변수는 **암묵적으로 전역 변수**가 되며, 이러한 변수를 **암묵적 전역 변수 (implicit global)**라 합니다.

단, 개발자의 의도와는 상관없이 동작하는 암묵적 전역 변수는 **오류의 발생 원인이 될 가능성**이 크기 때문에 변수를 선언할 때는 **반드시 `let`, `const` 키워드를 사용**하는 것이 좋습니다.

---

# ❓ 최소한의 전역변수 사용하는 방법

## 전역변수 객체를 만들어서 사용하기

```javascript
var MYAPP = {}

MYAPP.student = {
  name: 'Lee',
  gender: 'male',
}

console.log(MYAPP.student.name)
```

## 즉시 실행 함수를 이용하여 사용하기

```javascript
;(function () {
  var MYAPP = {}

  MYAPP.student = {
    name: 'Lee',
    gender: 'male',
  }

  console.log(MYAPP.student.name)
})()

console.log(MYAPP.student.name)
```

`즉시 실행 함수 (IIFE, Immediately-Invoked Function Expression)`를 사용하면 전역변수를 만들지 않으며,

즉시 실행 함수는 **즉시 실행되고 그 후 전역에서 바로 사라집니다**.

---

### 🔗 References

[Understanding JavaScript Scope](https://scotch.io/tutorials/understanding-scope-in-javascript)

[스코프](https://poiemaweb.com/js-scope)
